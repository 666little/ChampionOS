<!DOCTYPE html> 
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Champion OS</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --taskbar-color: rgba(15, 23, 42, 0.9);
            --window-bg: rgba(30, 41, 59, 0.95);
            --window-header: rgba(51, 65, 85, 0.9);
            --accent-color: #3b82f6;
            --accent-hover: #60a5fa;
            --text-color: #f8fafc;
            --text-secondary: #94a3b8;
            --icon-hover: rgba(148, 163, 184, 0.1);
            --window-border-radius: 12px;
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
            user-select: none;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(220, 38, 38, 0.1) 0%, transparent 50%);
        }
        
        /* Стили для загрузочного экрана */
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .boot-logo {
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }
        
        .boot-progress {
            width: 300px;
            height: 4px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .boot-progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--accent-color);
            transition: width 0.3s ease;
        }
        
        .boot-status {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 40px;
        }
        
        .boot-version {
            position: absolute;
            bottom: 30px;
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .desktop {
            height: calc(100% - 60px);
            position: relative;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .desktop.loaded {
            opacity: 1;
        }
        
        .taskbar {
            height: 60px;
            background-color: var(--taskbar-color);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
            position: fixed;
            bottom: 0;
            width: 100%;
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            z-index: 1000;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .taskbar.loaded {
            opacity: 1;
        }
        
        .taskbar-center {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .taskbar-icon {
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }
        
        .taskbar-icon:hover {
            background-color: var(--icon-hover);
        }
        
        .taskbar-icon.active {
            background-color: rgba(59, 130, 246, 0.2);
        }
        
        .taskbar-icon.active::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 3px;
            background-color: var(--accent-color);
            border-radius: 2px;
        }
        
        .taskbar-icon img {
            width: 24px;
            height: 24px;
            filter: brightness(0) invert(1);
        }
        
        .window {
            position: absolute;
            width: 800px;
            background-color: var(--window-bg);
            border-radius: var(--window-border-radius);
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            flex-direction: column;
            min-height: 500px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
            top: 50px;
            left: 50px;
        }
        
        .window.active {
            opacity: 1;
            transform: translateY(0);
            display: flex;
        }
        
        .window-header {
            background-color: var(--window-header);
            padding: 14px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .window-title {
            font-weight: 500;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
        }
        
        .window-title img {
            width: 18px;
            height: 18px;
        }
        
        .window-controls {
            display: flex;
            gap: 4px;
        }
        
        .window-controls button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            border-radius: 6px;
            font-size: 16px;
        }
        
        .window-controls button:hover {
            background-color: var(--icon-hover);
            color: var(--text-color);
        }
        
        .window-controls button.close:hover {
            background-color: #ef4444;
            color: white;
        }
        
        .window-content {
            padding: 20px;
            flex-grow: 1;
            overflow-y: auto;
        }
        
        .desktop-icon {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .desktop-icon:hover {
            background-color: var(--icon-hover);
        }
        
        .desktop-icon img {
            width: 48px;
            height: 48px;
            object-fit: contain;
            margin-bottom: 8px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .desktop-icon span {
            text-align: center;
            font-size: 12px;
            color: var(--text-color);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        /* Анимация загрузки */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Системное уведомление */
        .notification {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background-color: var(--window-bg);
            border-radius: var(--window-border-radius);
            padding: 16px;
            max-width: 300px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: translateX(120%);
            transition: transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
            z-index: 1001;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .notification-title img {
            width: 16px;
            height: 16px;
        }
        
        /* Контекстное меню */
        .context-menu {
            position: absolute;
            background-color: var(--window-bg);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 8px;
            min-width: 200px;
            z-index: 1002;
            display: none;
        }
        
        .context-menu-item {
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }
        
        .context-menu-item:hover {
            background-color: var(--icon-hover);
        }
        
        .context-menu-item img {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }
        
        /* Часы и дата */
        .time-date {
            position: absolute;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            font-size: 12px;
        }
        
        .time {
            font-size: 14px;
            font-weight: 500;
        }
        
        .date {
            color: var(--text-secondary);
        }

        /* Стили для тем */
        .theme-option {
            flex: 1;
            padding: 10px;
            background: #1e293b;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .theme-option:hover {
            border-color: var(--accent-color);
        }

        .theme-option.selected {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.1);
        }

        .theme-option.light {
            background: #f1f5f9;
            color: #0f172a;
        }

        .theme-option.dark {
            background: #1e293b;
            color: #f8fafc;
        }

        /* Стили для цветов акцента */
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected {
            border-color: white;
            transform: scale(1.1);
        }

        /* Стили для блокнота */
        .notepad-content {
            width: 100%;
            height: 100%;
            min-height: 400px;
            background-color: var(--window-bg);
            border: none;
            color: var(--text-color);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
            padding: 15px;
            resize: none;
            outline: none;
        }

        /* Стили для меню "Пуск" */
        .start-menu {
            position: fixed;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            max-height: 70vh;
            background-color: var(--window-bg);
            border-radius: var(--window-border-radius);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1001;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .start-menu.active {
            display: flex;
        }

        .start-menu-header {
            padding: 20px;
            background-color: var(--window-header);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .start-menu-search {
            width: 100%;
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: var(--text-color);
            font-size: 14px;
            outline: none;
        }

        .start-menu-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .start-menu-sidebar {
            width: 200px;
            background-color: rgba(0, 0, 0, 0.1);
            padding: 15px 0;
        }

        .start-menu-apps {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .start-menu-section {
            margin-bottom: 20px;
        }

        .start-menu-section-title {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
            padding-left: 10px;
        }

        .start-menu-app {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .start-menu-app:hover {
            background-color: var(--icon-hover);
        }

        .start-menu-app img {
            width: 24px;
            height: 24px;
            margin-right: 10px;
        }

        /* Стили для Microsoft 365 приложений */
        .m365-app {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .m365-app-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .m365-app-header img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }

        .m365-app-title {
            font-weight: 500;
        }

        .m365-app-content {
            display: flex;
            gap: 10px;
        }

        .m365-app-item {
            flex: 1;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .m365-app-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .m365-app-item img {
            width: 48px;
            height: 48px;
            margin-bottom: 5px;
        }

        .m365-app-item-name {
            font-size: 12px;
        }

        /* Стили для окон приложений Microsoft 365 */
        .m365-app-window {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        .m365-app-container {
            padding: 0;
            height: 100%;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .m365-app-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            flex-grow: 1;
            background: var(--window-bg);
        }

        .m365-app-nav {
            display: flex;
            background: var(--window-header);
            padding: 10px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .m365-app-nav-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 5px 10px;
            margin-right: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .m365-app-nav-btn:hover {
            background: var(--icon-hover);
            color: var(--text-color);
        }

        .m365-app-nav-btn.active {
            background: var(--accent-color);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Загрузочный экран -->
    <div class="boot-screen" id="bootScreen">
        <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" class="boot-logo" alt="Champion OS">
        <div class="boot-progress">
            <div class="boot-progress-bar" id="bootProgress"></div>
        </div>
        <div class="boot-status" id="bootStatus">Загрузка системы...</div>
        <div class="boot-version">Champion OS v2.0</div>
    </div>

    <div class="desktop" id="desktop">
        <!-- Иконки на рабочем столе -->
        <div class="desktop-icon" style="top: 40px; left: 40px;" onclick="openApp('settings')">
            <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="Настройки">
            <span>Настройки</span>
        </div>
        
        <div class="desktop-icon" style="top: 40px; left: 160px;" onclick="openApp('about')">
            <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="Информация">
            <span>О системе</span>
        </div>

        <div class="desktop-icon" style="top: 40px; left: 280px;" onclick="openApp('notepad')">
            <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="Блокнот">
            <span>Блокнот</span>
        </div>

        <div class="desktop-icon" style="top: 40px; left: 400px;" onclick="openApp('m365')">
            <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="Microsoft 365">
            <span>Microsoft 365</span>
        </div>
        
        <!-- Окна приложений -->
        <div class="window" id="settings">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="">
                    Настройки Champion OS
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('settings')">×</button>
                </div>
            </div>
            <div class="window-content">
                <h2 style="margin-top: 0; color: var(--accent-color);">Системные настройки</h2>
                
                <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                    <div style="flex: 1;">
                        <h3 style="margin-top: 0;">Информация о системе</h3>
                        <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px;">
                            <p><strong>Версия ОС:</strong> Champion OS 2.0</p>
                            <p><strong>Процессор:</strong> Champion Quantum Core</p>
                            <p><strong>Память:</strong> 16 ГБ</p>
                            <p><strong>Графика:</strong> Neon Accelerator</p>
                        </div>
                    </div>
                    <div style="flex: 1;">
                        <h3 style="margin-top: 0;">Персонализация</h3>
                        <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px;">
                            <div style="margin-bottom: 12px;">
                                <label style="display: block; margin-bottom: 6px;">Цвет акцента</label>
                                <div style="display: flex; gap: 8px;">
                                    <div class="color-option" style="background: #3b82f6;" onclick="changeAccentColor('#3b82f6', '#60a5fa')"></div>
                                    <div class="color-option" style="background: #10b981;" onclick="changeAccentColor('#10b981', '#34d399')"></div>
                                    <div class="color-option" style="background: #f59e0b;" onclick="changeAccentColor('#f59e0b', '#fbbf24')"></div>
                                    <div class="color-option" style="background: #ef4444;" onclick="changeAccentColor('#ef4444', '#f87171')"></div>
                                    <div class="color-option" style="background: #8b5cf6;" onclick="changeAccentColor('#8b5cf6', '#a78bfa')"></div>
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px;">Тема</label>
                                <div style="display: flex; gap: 8px;">
                                    <div class="theme-option dark selected" onclick="changeTheme('dark')">
                                        Темная
                                    </div>
                                    <div class="theme-option light" onclick="changeTheme('light')">
                                        Светлая
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="window" id="about">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="">
                    О системе Champion OS
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('about')">×</button>
                </div>
            </div>
            <div class="window-content">
                <h2 style="margin-top: 0; color: var(--accent-color);">Информация о системе</h2>
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" width="80" style="margin-bottom: 16px;">
                        <h2 style="margin: 0;">Champion OS</h2>
                        <p style="color: var(--text-secondary); margin-top: 4px;">Версия 2.0</p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div>
                            <h3 style="margin-top: 0;">Системная информация</h3>
                            <p><strong>ОС:</strong> Champion OS 2.0</p>
                            <p><strong>Архитектура:</strong> 64-bit</p>
                            <p><strong>Процессор:</strong> Champion Quantum Core</p>
                            <p><strong>Память:</strong> 16 ГБ</p>
                        </div>
                        <div>
                            <h3 style="margin-top: 0;">Разработчик</h3>
                            <p>Champion Software Inc.</p>
                            <p>© 2023 Все права защищены</p>
                            <p>Лицензия: Proprietary</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <button style="background: var(--accent-color); border: none; color: white; padding: 10px 20px; border-radius: 6px; cursor: pointer; transition: var(--transition);">
                            Проверить обновления
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Блокнот -->
        <div class="window" id="notepad">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="">
                    Блокнот - Безымянный
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('notepad')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <textarea class="notepad-content" placeholder="Введите текст здесь..."></textarea>
            </div>
        </div>

        <!-- Microsoft 365 -->
        <div class="window" id="m365">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="">
                    Microsoft 365
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('m365')">×</button>
                </div>
            </div>
            <div class="window-content">
                <h2 style="margin-top: 0; color: var(--accent-color);">Microsoft 365</h2>
                <p>Выберите приложение для работы:</p>
                
                <div class="m365-app">
                    <div class="m365-app-header">
                        <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="Microsoft 365">
                        <div class="m365-app-title">Основные приложения</div>
                    </div>
                    <div class="m365-app-content">
                        <div class="m365-app-item" onclick="openM365App('word')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888882.png" alt="Word">
                            <div class="m365-app-item-name">Word</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('excel')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888883.png" alt="Excel">
                            <div class="m365-app-item-name">Excel</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('powerpoint')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888885.png" alt="PowerPoint">
                            <div class="m365-app-item-name">PowerPoint</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('outlook')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888884.png" alt="Outlook">
                            <div class="m365-app-item-name">Outlook</div>
                        </div>
                    </div>
                </div>

                <div class="m365-app">
                    <div class="m365-app-header">
                        <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="Microsoft 365">
                        <div class="m365-app-title">Другие приложения</div>
                    </div>
                    <div class="m365-app-content">
                        <div class="m365-app-item" onclick="openM365App('onenote')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888887.png" alt="OneNote">
                            <div class="m365-app-item-name">OneNote</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('onedrive')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888859.png" alt="OneDrive">
                            <div class="m365-app-item-name">OneDrive</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('teams')">
                            <img src="https://cdn-icons-png.flaticon.com/512/906/906308.png" alt="Teams">
                            <div class="m365-app-item-name">Teams</div>
                        </div>
                        <div class="m365-app-item" onclick="openM365App('publisher')">
                            <img src="https://cdn-icons-png.flaticon.com/512/888/888890.png" alt="Publisher">
                            <div class="m365-app-item-name">Publisher</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Окна приложений Microsoft 365 -->
        <div class="window" id="word">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/888/888882.png" alt="">
                    Microsoft Word
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('word')">×</button>
                </div>
            </div>
            <div class="m365-app-container">
                <div class="m365-app-nav">
                    <button class="m365-app-nav-btn" onclick="switchM365App('word')">Word</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('excel')">Excel</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('powerpoint')">PowerPoint</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('outlook')">Outlook</button>
                </div>
                <iframe src="https://www.office.com/launch/word" class="m365-app-window" frameborder="0"></iframe>
                <div class="m365-app-loading" style="display: none;">
                    <p>Загрузка Microsoft Word...</p>
                </div>
            </div>
        </div>

        <div class="window" id="excel">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/888/888883.png" alt="">
                    Microsoft Excel
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('excel')">×</button>
                </div>
            </div>
            <div class="m365-app-container">
                <div class="m365-app-nav">
                    <button class="m365-app-nav-btn" onclick="switchM365App('word')">Word</button>
                    <button class="m365-app-nav-btn active" onclick="switchM365App('excel')">Excel</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('powerpoint')">PowerPoint</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('outlook')">Outlook</button>
                </div>
                <iframe src="https://www.office.com/launch/excel" class="m365-app-window" frameborder="0"></iframe>
                <div class="m365-app-loading" style="display: none;">
                    <p>Загрузка Microsoft Excel...</p>
                </div>
            </div>
        </div>

        <div class="window" id="powerpoint">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/888/888885.png" alt="">
                    Microsoft PowerPoint
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('powerpoint')">×</button>
                </div>
            </div>
            <div class="m365-app-container">
                <div class="m365-app-nav">
                    <button class="m365-app-nav-btn" onclick="switchM365App('word')">Word</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('excel')">Excel</button>
                    <button class="m365-app-nav-btn active" onclick="switchM365App('powerpoint')">PowerPoint</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('outlook')">Outlook</button>
                </div>
                <iframe src="https://www.office.com/launch/powerpoint" class="m365-app-window" frameborder="0"></iframe>
                <div class="m365-app-loading" style="display: none;">
                    <p>Загрузка Microsoft PowerPoint...</p>
                </div>
            </div>
        </div>

        <div class="window" id="outlook">
            <div class="window-header">
                <div class="window-title">
                    <img src="https://cdn-icons-png.flaticon.com/512/888/888884.png" alt="">
                    Microsoft Outlook
                </div>
                <div class="window-controls">
                    <button class="minimize">─</button>
                    <button class="maximize">□</button>
                    <button class="close" onclick="closeApp('outlook')">×</button>
                </div>
            </div>
            <div class="m365-app-container">
                <div class="m365-app-nav">
                    <button class="m365-app-nav-btn" onclick="switchM365App('word')">Word</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('excel')">Excel</button>
                    <button class="m365-app-nav-btn" onclick="switchM365App('powerpoint')">PowerPoint</button>
                    <button class="m365-app-nav-btn active" onclick="switchM365App('outlook')">Outlook</button>
                </div>
                <iframe src="https://www.office.com/launch/outlook" class="m365-app-window" frameborder="0"></iframe>
                <div class="m365-app-loading" style="display: none;">
                    <p>Загрузка Microsoft Outlook...</p>
                </div>
            </div>
        </div>
        
        <!-- Уведомление -->
        <div class="notification" id="notification">
            <div class="notification-title">
                <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="">
                <span id="notification-title">Уведомление</span>
            </div>
            <div id="notification-message">Сообщение уведомления</div>
        </div>
        
        <!-- Контекстное меню -->
        <div class="context-menu" id="context-menu">
            <div class="context-menu-item" onclick="openApp('settings')">
                <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="">
                <span>Настройки</span>
            </div>
            <div class="context-menu-item" onclick="openApp('about')">
                <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="">
                <span>О системе</span>
            </div>
            <div class="context-menu-item" onclick="openApp('notepad')">
                <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="">
                <span>Блокнот</span>
            </div>
            <div class="context-menu-item" onclick="openApp('m365')">
                <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="">
                <span>Microsoft 365</span>
            </div>
            <div style="height: 1px; background: rgba(255,255,255,0.1); margin: 8px 0;"></div>
            <div class="context-menu-item">
                <img src="https://cdn-icons-png.flaticon.com/512/1828/1828665.png" alt="">
                <span>Обновить</span>
            </div>
        </div>

        <!-- Меню "Пуск" -->
        <div class="start-menu" id="startMenu">
            <div class="start-menu-header">
                <input type="text" class="start-menu-search" placeholder="Поиск в системе...">
            </div>
            <div class="start-menu-content">
                <div class="start-menu-sidebar">
                    <div class="start-menu-section">
                        <div class="start-menu-section-title">Часто используемые</div>
                        <div class="start-menu-app" onclick="openApp('notepad')">
                            <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="">
                            <span>Блокнот</span>
                        </div>
                        <div class="start-menu-app" onclick="openApp('settings')">
                            <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="">
                            <span>Настройки</span>
                        </div>
                    </div>
                    <div class="start-menu-section">
                        <div class="start-menu-section-title">Рекомендуемые</div>
                        <div class="start-menu-app" onclick="openApp('m365')">
                            <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="">
                            <span>Microsoft 365</span>
                        </div>
                        <div class="start-menu-app" onclick="openApp('about')">
                            <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="">
                            <span>О системе</span>
                        </div>
                    </div>
                </div>
                <div class="start-menu-apps">
                    <div class="start-menu-section">
                        <div class="start-menu-section-title">Приложения</div>
                        <div class="start-menu-app" onclick="openApp('notepad')">
                            <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="">
                            <span>Блокнот</span>
                        </div>
                        <div class="start-menu-app" onclick="openApp('m365')">
                            <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="">
                            <span>Microsoft 365</span>
                        </div>
                        <div class="start-menu-app" onclick="openApp('settings')">
                            <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="">
                            <span>Настройки</span>
                        </div>
                        <div class="start-menu-app" onclick="openApp('about')">
                            <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="">
                            <span>О системе</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="taskbar">
        <div class="taskbar-center">
            <div class="taskbar-icon" onclick="toggleStartMenu()">
                <img src="https://cdn-icons-png.flaticon.com/512/3917/3917036.png" alt="Пуск">
            </div>
            <div class="taskbar-icon" onclick="openApp('settings')">
                <img src="https://cdn-icons-png.flaticon.com/512/3176/3176272.png" alt="Настройки">
            </div>
            <div class="taskbar-icon" onclick="openApp('notepad')">
                <img src="https://cdn-icons-png.flaticon.com/512/2592/2592236.png" alt="Блокнот">
            </div>
            <div class="taskbar-icon" onclick="openApp('m365')">
                <img src="https://cdn-icons-png.flaticon.com/512/732/732220.png" alt="Microsoft 365">
            </div>
        </div>
        
        <div class="time-date">
            <div class="time" id="time">00:00</div>
            <div class="date" id="date">1 января 2023</div>
        </div>
    </div>
    
    <script>
        // Функция для имитации загрузки системы
        function simulateBoot() {
            const bootScreen = document.getElementById('bootScreen');
            const bootProgress = document.getElementById('bootProgress');
            const bootStatus = document.getElementById('bootStatus');
            const desktop = document.getElementById('desktop');
            const taskbar = document.querySelector('.taskbar');
            
            const steps = [
                { progress: 10, status: "Инициализация ядра..." },
                { progress: 25, status: "Загрузка драйверов..." },
                { progress: 40, status: "Подготовка файловой системы..." },
                { progress: 60, status: "Запуск системных служб..." },
                { progress: 80, status: "Загрузка графической оболочки..." },
                { progress: 100, status: "Завершение загрузки..." }
            ];
            
            let currentStep = 0;
            
            function updateBootProgress() {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    bootProgress.style.width = step.progress + '%';
                    bootStatus.textContent = step.status;
                    currentStep++;
                    
                    // Рандомная задержка между шагами для реалистичности
                    const delay = 300 + Math.random() * 700;
                    setTimeout(updateBootProgress, delay);
                } else {
                    // Загрузка завершена
                    bootScreen.style.opacity = '0';
                    setTimeout(() => {
                        bootScreen.style.display = 'none';
                        desktop.classList.add('loaded');
                        taskbar.classList.add('loaded');
                        
                        // Показать уведомление о загрузке
                        setTimeout(() => {
                            showNotification('Champion OS', 'Система успешно загружена');
                        }, 500);
                    }, 500);
                }
            }
            
            // Начинаем процесс загрузки
            setTimeout(updateBootProgress, 500);
        }
        
        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            // Сначала показываем загрузочный экран
            simulateBoot();
            
            // Затем инициализируем остальные компоненты
            updateClock();
            setInterval(updateClock, 1000);
            
            // Инициализация контекстного меню
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                const contextMenu = document.getElementById('context-menu');
                contextMenu.style.display = 'block';
                contextMenu.style.left = e.clientX + 'px';
                contextMenu.style.top = e.clientY + 'px';
            });
            
            document.addEventListener('click', function(e) {
                document.getElementById('context-menu').style.display = 'none';
                
                // Закрытие меню "Пуск" при клике вне его
                const startMenu = document.getElementById('startMenu');
                const startButton = document.querySelector('.taskbar-icon[onclick="toggleStartMenu()"]');
                
                if (!startMenu.contains(e.target)) {
                    const isStartButton = e.target === startButton || startButton.contains(e.target);
                    
                    if (!isStartButton) {
                        startMenu.classList.remove('active');
                    }
                }
            });
        });
        
        // Функции для работы с окнами
        function openApp(appId) {
            const app = document.getElementById(appId);
            if (!app) return;
            
            app.classList.add('active');
            app.style.display = 'flex';
            
            // Обновить активную иконку в панели задач
            document.querySelectorAll('.taskbar-icon').forEach(icon => {
                icon.classList.remove('active');
                if (icon.onclick && icon.onclick.toString().includes(appId)) {
                    icon.classList.add('active');
                }
            });
            
            // Закрыть меню "Пуск" при открытии приложения
            document.getElementById('startMenu').classList.remove('active');
        }
        
        function closeApp(appId) {
            const app = document.getElementById(appId);
            app.classList.remove('active');
            setTimeout(() => {
                app.style.display = 'none';
            }, 300);
            
            // Убрать активность с иконки в панели задач
            document.querySelectorAll('.taskbar-icon').forEach(icon => {
                if (icon.onclick && icon.onclick.toString().includes(appId)) {
                    icon.classList.remove('active');
                }
            });
        }
        
        // Управление уведомлениями
        function showNotification(title, message) {
            const notification = document.getElementById('notification');
            document.getElementById('notification-title').textContent = title;
            document.getElementById('notification-message').textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Часы и дата
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const date = now.toLocaleDateString([], { day: 'numeric', month: 'long', year: 'numeric' });
            
            document.getElementById('time').textContent = time;
            document.getElementById('date').textContent = date;
        }
        
        // Перетаскивание окон
        const windows = document.querySelectorAll('.window');
        windows.forEach(window => {
            const header = window.querySelector('.window-header');
            header.onmousedown = function(e) {
                if (e.target.tagName === 'BUTTON') return;
                
                const startX = e.clientX;
                const startY = e.clientY;
                const startLeft = window.offsetLeft;
                const startTop = window.offsetTop;
                
                document.onmousemove = function(e) {
                    const newX = startLeft + e.clientX - startX;
                    const newY = startTop + e.clientY - startY;
                    window.style.left = newX + 'px';
                    window.style.top = newY + 'px';
                };
                
                document.onmouseup = function() {
                    document.onmousemove = null;
                    document.onmouseup = null;
                };
            };
        });

        // Функция для изменения темы
        function changeTheme(theme) {
            const darkThemeOption = document.querySelector('.theme-option.dark');
            const lightThemeOption = document.querySelector('.theme-option.light');

            if (theme === 'dark') {
                // Устанавливаем темную тему
                document.documentElement.style.setProperty('--bg-color', '#0f172a');
                document.documentElement.style.setProperty('--taskbar-color', 'rgba(15, 23, 42, 0.9)');
                document.documentElement.style.setProperty('--window-bg', 'rgba(30, 41, 59, 0.95)');
                document.documentElement.style.setProperty('--window-header', 'rgba(51, 65, 85, 0.9)');
                document.documentElement.style.setProperty('--text-color', '#f8fafc');
                document.documentElement.style.setProperty('--text-secondary', '#94a3b8');
                
                darkThemeOption.classList.add('selected');
                lightThemeOption.classList.remove('selected');
            } else {
                // Устанавливаем светлую тему
                document.documentElement.style.setProperty('--bg-color', '#f1f5f9');
                document.documentElement.style.setProperty('--taskbar-color', 'rgba(241, 245, 249, 0.9)');
                document.documentElement.style.setProperty('--window-bg', 'rgba(255, 255, 255, 0.95)');
                document.documentElement.style.setProperty('--window-header', 'rgba(226, 232, 240, 0.9)');
                document.documentElement.style.setProperty('--text-color', '#0f172a');
                document.documentElement.style.setProperty('--text-secondary', '#64748b');
                
                lightThemeOption.classList.add('selected');
                darkThemeOption.classList.remove('selected');
            }

            // Показываем уведомление о смене темы
            showNotification('Champion OS', `Тема изменена на ${theme === 'dark' ? 'темную' : 'светлую'}`);
        }

        // Функция для изменения цвета акцента
        function changeAccentColor(color, hoverColor) {
            document.documentElement.style.setProperty('--accent-color', color);
            document.documentElement.style.setProperty('--accent-hover', hoverColor);
            
            // Обновляем выбранный цвет
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('selected');
                if (option.style.backgroundColor === color) {
                    option.classList.add('selected');
                }
            });

            // Показываем уведомление о смене цвета
            showNotification('Champion OS', 'Цвет акцента изменен');
        }

        // Функция для переключения меню "Пуск"
        function toggleStartMenu() {
            const startMenu = document.getElementById('startMenu');
            startMenu.classList.toggle('active');
        }

        // Функции для работы с Microsoft 365
        function openM365App(appName) {
            let appId = appName;
            let appTitle = '';
            let appIcon = '';
            let appUrl = '';

            // Определяем параметры приложения
            switch(appName) {
                case 'word':
                    appTitle = 'Microsoft Word';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888882.png';
                    appUrl = 'https://www.office.com/launch/word';
                    break;
                case 'excel':
                    appTitle = 'Microsoft Excel';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888883.png';
                    appUrl = 'https://www.office.com/launch/excel';
                    break;
                case 'powerpoint':
                    appTitle = 'Microsoft PowerPoint';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888885.png';
                    appUrl = 'https://www.office.com/launch/powerpoint';
                    break;
                case 'outlook':
                    appTitle = 'Microsoft Outlook';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888884.png';
                    appUrl = 'https://www.office.com/launch/outlook';
                    break;
                case 'onenote':
                    appTitle = 'Microsoft OneNote';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888887.png';
                    appUrl = 'https://www.office.com/launch/onenote';
                    break;
                case 'onedrive':
                    appTitle = 'Microsoft OneDrive';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888859.png';
                    appUrl = 'https://www.office.com/launch/onedrive';
                    break;
                case 'teams':
                    appTitle = 'Microsoft Teams';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/906/906308.png';
                    appUrl = 'https://www.office.com/launch/teams';
                    break;
                case 'publisher':
                    appTitle = 'Microsoft Publisher';
                    appIcon = 'https://cdn-icons-png.flaticon.com/512/888/888890.png';
                    appUrl = 'https://www.office.com/launch/publisher';
                    break;
                default:
                    return;
            }

            // Проверяем, существует ли уже окно для этого приложения
            let appWindow = document.getElementById(appId);
            
            if (!appWindow) {
                // Создаем новое окно, если его нет
                appWindow = document.createElement('div');
                appWindow.className = 'window';
                appWindow.id = appId;
                appWindow.style.display = 'none';
                appWindow.style.opacity = '0';
                
                appWindow.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">
                            <img src="${appIcon}" alt="">
                            ${appTitle}
                        </div>
                        <div class="window-controls">
                            <button class="minimize">─</button>
                            <button class="maximize">□</button>
                            <button class="close" onclick="closeApp('${appId}')">×</button>
                        </div>
                    </div>
                    <div class="m365-app-container">
                        <div class="m365-app-nav">
                            <button class="m365-app-nav-btn" onclick="switchM365App('word')">Word</button>
                            <button class="m365-app-nav-btn" onclick="switchM365App('excel')">Excel</button>
                            <button class="m365-app-nav-btn" onclick="switchM365App('powerpoint')">PowerPoint</button>
                            <button class="m365-app-nav-btn" onclick="switchM365App('outlook')">Outlook</button>
                        </div>
                        <iframe src="${appUrl}" class="m365-app-window" frameborder="0"></iframe>
                        <div class="m365-app-loading">
                            <p>Загрузка ${appTitle}...</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('desktop').appendChild(appWindow);
                
                // Инициализация перетаскивания для нового окна
                const header = appWindow.querySelector('.window-header');
                header.onmousedown = function(e) {
                    if (e.target.tagName === 'BUTTON') return;
                    
                    const startX = e.clientX;
                    const startY = e.clientY;
                    const startLeft = appWindow.offsetLeft;
                    const startTop = appWindow.offsetTop;
                    
                    document.onmousemove = function(e) {
                        const newX = startLeft + e.clientX - startX;
                        const newY = startTop + e.clientY - startY;
                        appWindow.style.left = newX + 'px';
                        appWindow.style.top = newY + 'px';
                    };
                    
                    document.onmouseup = function() {
                        document.onmousemove = null;
                        document.onmouseup = null;
                    };
                };
            }
            
            // Показываем окно приложения
            appWindow.classList.add('active');
            appWindow.style.display = 'flex';
            
            // Обновляем активную кнопку в навигации
            const navBtns = appWindow.querySelectorAll('.m365-app-nav-btn');
            navBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === appTitle.split(' ')[1]) {
                    btn.classList.add('active');
                }
            });
            
            // Показываем уведомление
            showNotification('Microsoft 365', `Запуск ${appTitle}...`);
            
            // Обновляем активную иконку в панели задач
            document.querySelectorAll('.taskbar-icon').forEach(icon => {
                icon.classList.remove('active');
            });
        }

        function switchM365App(appName) {
            openM365App(appName);
        }
    </script>
</body>
</html>